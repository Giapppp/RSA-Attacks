

# This file was *autogenerated* from the file 20/20.sage
from sage.all_cmdline import *   # import sage library

_sage_const_20737327416821920632833766243325080758744476602106891552659668248211928837834891614061543881712747098223069067166397780317364548878488091500180405263451319073186308703781128650231796621861765292405135590240379862113867601365075024522913159419716687004742866970256672149527655077672692783327139845725927044676414720708275480356120514068737338161375974632329716667545458789820946763906744602608113970939204090363386200220523429539105997784719688145951872379100508867095774207813068037485162567725256317153472917693968172511905415528284096224249135114493566841626232930326427613792744178056780186252625412316994318442659 = Integer(20737327416821920632833766243325080758744476602106891552659668248211928837834891614061543881712747098223069067166397780317364548878488091500180405263451319073186308703781128650231796621861765292405135590240379862113867601365075024522913159419716687004742866970256672149527655077672692783327139845725927044676414720708275480356120514068737338161375974632329716667545458789820946763906744602608113970939204090363386200220523429539105997784719688145951872379100508867095774207813068037485162567725256317153472917693968172511905415528284096224249135114493566841626232930326427613792744178056780186252625412316994318442659); _sage_const_5 = Integer(5); _sage_const_16848812736153636549730446655896901182771129742230481957013133381873178339957246786942017800157377677325250400300575155998390559161978018407938206458723171575343936137546301401033039614383268906009304871091323173368026710187365698707901569456302907904851123849568373245528952411685349858520593184385677437950978106347988346685037618156882413152994960829720792606029256062257531123978134063015190821129198203423400666420877132867282080003862934732212786277470238846265038968171058174728417149606229823496696209113364610864436206158328464253321567249925929277718626598433683600184403064456802049535695840400339820560009 = Integer(16848812736153636549730446655896901182771129742230481957013133381873178339957246786942017800157377677325250400300575155998390559161978018407938206458723171575343936137546301401033039614383268906009304871091323173368026710187365698707901569456302907904851123849568373245528952411685349858520593184385677437950978106347988346685037618156882413152994960829720792606029256062257531123978134063015190821129198203423400666420877132867282080003862934732212786277470238846265038968171058174728417149606229823496696209113364610864436206158328464253321567249925929277718626598433683600184403064456802049535695840400339820560009); _sage_const_2 = Integer(2); _sage_const_72 = Integer(72); _sage_const_64 = Integer(64); _sage_const_31 = Integer(31); _sage_const_8 = Integer(8); _sage_const_0 = Integer(0)# Stereotyped Message attack with many unknown parts

from Crypto.Util.number import *
from sage.all import *
import sys
sys.path.append("../../Tools/lattice-based-cryptanalysis")
from lbc_toolkit import rsa_stereotyped_message_multi
"""
with open("20/output.txt", "r") as f:
    n = Integer(int(f.readline().split(" = ")[1]))
    e = Integer(int(f.readline().split(" = ")[1]))
    c = Integer(int(f.readline().split(" = ")[1]))
"""
n = _sage_const_20737327416821920632833766243325080758744476602106891552659668248211928837834891614061543881712747098223069067166397780317364548878488091500180405263451319073186308703781128650231796621861765292405135590240379862113867601365075024522913159419716687004742866970256672149527655077672692783327139845725927044676414720708275480356120514068737338161375974632329716667545458789820946763906744602608113970939204090363386200220523429539105997784719688145951872379100508867095774207813068037485162567725256317153472917693968172511905415528284096224249135114493566841626232930326427613792744178056780186252625412316994318442659 
e = _sage_const_5 
c = _sage_const_16848812736153636549730446655896901182771129742230481957013133381873178339957246786942017800157377677325250400300575155998390559161978018407938206458723171575343936137546301401033039614383268906009304871091323173368026710187365698707901569456302907904851123849568373245528952411685349858520593184385677437950978106347988346685037618156882413152994960829720792606029256062257531123978134063015190821129198203423400666420877132867282080003862934732212786277470238846265038968171058174728417149606229823496696209113364610864436206158328464253321567249925929277718626598433683600184403064456802049535695840400339820560009 

known = b"Flag has two parts, the first one is \x00\x00\x00\x00\x00\x00\x00\x00\x00 and the second one is \x00\x00\x00\x00\x00\x00\x00\x00"
known_int = bytes_to_long(known)
assert known_int < n

Xs = (_sage_const_2 **_sage_const_72 , _sage_const_2 **_sage_const_64 )
ts = [_sage_const_31 *_sage_const_8 , _sage_const_0 ]
x = rsa_stereotyped_message_multi(n, e, c, known_int, Xs, ts)
print(x)

