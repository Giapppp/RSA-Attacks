# Stereotyped Message attack with many unknown parts

from Crypto.Util.number import *
from sage.all import *
import sys

"""
with open("20/output.txt", "r") as f:
    n = Integer(int(f.readline().split(" = ")[1]))
    e = Integer(int(f.readline().split(" = ")[1]))
    c = Integer(int(f.readline().split(" = ")[1]))
"""
n = 20737327416821920632833766243325080758744476602106891552659668248211928837834891614061543881712747098223069067166397780317364548878488091500180405263451319073186308703781128650231796621861765292405135590240379862113867601365075024522913159419716687004742866970256672149527655077672692783327139845725927044676414720708275480356120514068737338161375974632329716667545458789820946763906744602608113970939204090363386200220523429539105997784719688145951872379100508867095774207813068037485162567725256317153472917693968172511905415528284096224249135114493566841626232930326427613792744178056780186252625412316994318442659
e = 5
c = 16848812736153636549730446655896901182771129742230481957013133381873178339957246786942017800157377677325250400300575155998390559161978018407938206458723171575343936137546301401033039614383268906009304871091323173368026710187365698707901569456302907904851123849568373245528952411685349858520593184385677437950978106347988346685037618156882413152994960829720792606029256062257531123978134063015190821129198203423400666420877132867282080003862934732212786277470238846265038968171058174728417149606229823496696209113364610864436206158328464253321567249925929277718626598433683600184403064456802049535695840400339820560009

known = b"Flag has two parts, the first one is \x00\x00\x00\x00\x00\x00\x00\x00\x00 and the second one is \x00\x00\x00\x00\x00\x00\x00\x00"
known_int = bytes_to_long(known)
assert known_int < n

x, y = PolynomialRing(Zmod(n), "x,y").gens()
f = (known_int + 2**(31*8) * x + y)**e - c
print(f(0, 0))
